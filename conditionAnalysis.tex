% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  landscape]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Condition anaylsis},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{Condition anaylsis}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\begin{verbatim}
## -- Attaching packages ------------------------------------------------------------------------------------------------------------ tidyverse 1.3.0 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.0     v purrr   0.3.4
## v tibble  3.0.1     v dplyr   0.8.5
## v tidyr   1.1.0     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0
\end{verbatim}

\begin{verbatim}
## -- Conflicts --------------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{verbatim}
## Loading required package: Matrix
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'Matrix'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:tidyr':
## 
##     expand, pack, unpack
\end{verbatim}

If newData, then will load raw files, parse, filter and save as `dat'

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{newData =}\StringTok{ }\OtherTok{FALSE}
\NormalTok{date <-}\StringTok{ 'May27'} \CommentTok{#suffix for data subdriectory}
\end{Highlighting}
\end{Shaded}

Only need to run this with new data - data output as `dat'

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{(newData)\{}

  \CommentTok{#bring in all of the fish size data}
\NormalTok{  fish <-}\StringTok{ }\KeywordTok{list.files}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"D:/projects/ecoDrought/bodySize/All_Size_inputs/Size_inputs_"}\NormalTok{, date), }\DataTypeTok{pattern =} \StringTok{"*.txt"}\NormalTok{, }\DataTypeTok{full.names =}\NormalTok{ T)}
  
\NormalTok{  txt_files_df <-}\StringTok{ }\KeywordTok{lapply}\NormalTok{(fish, }\ControlFlowTok{function}\NormalTok{(x) \{}\KeywordTok{read.table}\NormalTok{(}\DataTypeTok{file =}\NormalTok{ x, }\DataTypeTok{header =}\NormalTok{ T, }\DataTypeTok{sep =}\StringTok{","}\NormalTok{)\})}
  
\NormalTok{  all_fish <-}\StringTok{ }\KeywordTok{do.call}\NormalTok{(}\StringTok{"rbind"}\NormalTok{, }\KeywordTok{lapply}\NormalTok{(txt_files_df, as.data.frame))}
  
  \CommentTok{##bring in the covariate data}
\NormalTok{  covs <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"D:/projects/ecoDrought/bodySize/All_Size_inputs/covariates_size_analysis.csv"}\NormalTok{)}
  
  \CommentTok{#merge fish data with covariate data}
\NormalTok{  all_fish_init<-}\KeywordTok{merge}\NormalTok{(all_fish, covs, }\DataTypeTok{by =} \StringTok{"RALLID"}\NormalTok{)}
  
  \CommentTok{#Select only those fish of interest}
  
  \CommentTok{#species of interest AND    #get rid of weir data}
\NormalTok{  sinc <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Bonneville Cutthroat Trout"}\NormalTok{,}\StringTok{"Colorado River Cutthroat Trout"}\NormalTok{,}\StringTok{"Redband Trout"}\NormalTok{,}\StringTok{"Bull Trout"}\NormalTok{,}\StringTok{"Brook Trout"}\NormalTok{,}\StringTok{"Mountain Whitefish"}\NormalTok{,}\StringTok{"Brown Trout"}\NormalTok{,}\StringTok{"Westslope Cutthroat Trout"}\NormalTok{, }\StringTok{"Yellowstone Cutthroat Trout"}\NormalTok{,}\StringTok{"Rainbow Trout"}\NormalTok{)}
  
\NormalTok{  nw <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Lake"}\NormalTok{,}\StringTok{"stream"}\NormalTok{)}
  
\NormalTok{  dat <-}\StringTok{ }\NormalTok{all_fish_init }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{filter}\NormalTok{(species }\OperatorTok{%in%}\StringTok{ }\NormalTok{sinc, site_type }\OperatorTok{%in%}\StringTok{ }\NormalTok{nw,}
           \OperatorTok{!}\KeywordTok{is.na}\NormalTok{(Weight), Length }\OperatorTok{>}\StringTok{ }\DecValTok{75}\NormalTok{) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{rename}\NormalTok{(}\DataTypeTok{weight =}\NormalTok{ Weight, }\DataTypeTok{length =}\NormalTok{ Length) }\OperatorTok{%>%}
\StringTok{    }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{log10Weight =} \KeywordTok{log10}\NormalTok{(weight), }\DataTypeTok{log10Length =} \KeywordTok{log10}\NormalTok{(length))}
    
  \KeywordTok{save}\NormalTok{(dat, }\DataTypeTok{file =}\KeywordTok{paste0}\NormalTok{(}\StringTok{"D:/projects/ecoDrought/bodySize/All_Size_inputs/Size_inputs_"}\NormalTok{, date,}\StringTok{"/dat.R"}\NormalTok{))}
  
  \KeywordTok{rm}\NormalTok{(all_fish_init, all_fish)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{(newData) \{}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{)) \{}
    \KeywordTok{print}\NormalTok{(i)}
    
    \KeywordTok{ggplot}\NormalTok{(dat }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(species }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(sinc[i])), }\KeywordTok{aes}\NormalTok{(log10Length, log10Weight, }\DataTypeTok{color =}\NormalTok{ site_type)) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{'lm'}\NormalTok{) }\OperatorTok{+}
\StringTok{      }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\StringTok{ }\NormalTok{species)}
    
    \KeywordTok{ggsave}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"D:/projects/ecoDrought/bodySize/All_Size_inputs/ecoDrought_conditionAnalysis/charts/LW_"}\NormalTok{,sinc[i],}\StringTok{".png"}\NormalTok{))}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{(}\OperatorTok{!}\NormalTok{newData)\{}
  \KeywordTok{load}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"D:/projects/ecoDrought/bodySize/All_Size_inputs/Size_inputs_"}\NormalTok{, date,}\StringTok{"/dat.R"}\NormalTok{))}
\NormalTok{  speciesList <-}\StringTok{ }\KeywordTok{unique}\NormalTok{(dat}\OperatorTok{$}\NormalTok{species)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Species have different LW relationships. No random effects yet - lmer
takes a long time to run (may try bam,
\url{https://m-clark.github.io/posts/2019-10-20-big-mixed-models/})

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{(newData) \{}
    \KeywordTok{ggplot}\NormalTok{(dat, }\KeywordTok{aes}\NormalTok{(log10Length, log10Weight, }\DataTypeTok{color =}\NormalTok{ species)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{'lm'}\NormalTok{) }
   
    \KeywordTok{ggsave}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"D:/projects/ecoDrought/bodySize/All_Size_inputs/ecoDrought_conditionAnalysis/charts/LWbySpecies.png"}\NormalTok{))}
\NormalTok{\}}

\CommentTok{#modSpp1 <- lmer(log10Weight ~ log10Length * species + 1|HUC8_Name, data = dat) very slow}
\NormalTok{modSpp0 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(log10Weight }\OperatorTok{~}\StringTok{ }\NormalTok{log10Length, }\DataTypeTok{data =}\NormalTok{ dat)}
\NormalTok{modSpp1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(log10Weight }\OperatorTok{~}\StringTok{ }\NormalTok{log10Length }\OperatorTok{*}\StringTok{ }\NormalTok{species, }\DataTypeTok{data =}\NormalTok{ dat)}


\KeywordTok{AIC}\NormalTok{(modSpp0, modSpp1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         df      AIC
## modSpp0  3 -5291890
## modSpp1 19 -5393099
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# species have different slopes and intercepts}
\KeywordTok{anova}\NormalTok{(modSpp1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: log10Weight
##                          Df Sum Sq Mean Sq    F value    Pr(>F)    
## log10Length               1 641647  641647 1.2784e+08 < 2.2e-16 ***
## species                   8    378      47 9.4028e+03 < 2.2e-16 ***
## log10Length:species       8    142      18 3.5485e+03 < 2.2e-16 ***
## Residuals           2195321  11019       0                         
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(modSpp1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = log10Weight ~ log10Length * species, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.04912 -0.03807 -0.00123  0.03644  1.01258 
## 
## Coefficients:
##                                                    Estimate Std. Error  t value
## (Intercept)                                       -5.051251   0.005743 -879.488
## log10Length                                        3.020625   0.002615 1155.248
## speciesBrook Trout                                -0.083824   0.006439  -13.019
## speciesBrown Trout                                 0.287790   0.005853   49.169
## speciesBull Trout                                  0.104296   0.007263   14.359
## speciesColorado River Cutthroat Trout             -0.346001   0.059544   -5.811
## speciesMountain Whitefish                         -0.060433   0.007550   -8.005
## speciesRainbow Trout                               0.310209   0.005902   52.561
## speciesWestslope Cutthroat Trout                   0.071843   0.006130   11.720
## speciesYellowstone Cutthroat Trout                 0.034974   0.006547    5.342
## log10Length:speciesBrook Trout                     0.044371   0.002930   15.141
## log10Length:speciesBrown Trout                    -0.118014   0.002654  -44.468
## log10Length:speciesBull Trout                     -0.061964   0.003256  -19.028
## log10Length:speciesColorado River Cutthroat Trout  0.159067   0.029153    5.456
## log10Length:speciesMountain Whitefish              0.012588   0.003285    3.832
## log10Length:speciesRainbow Trout                  -0.119975   0.002672  -44.907
## log10Length:speciesWestslope Cutthroat Trout      -0.031161   0.002786  -11.183
## log10Length:speciesYellowstone Cutthroat Trout    -0.013232   0.002925   -4.524
##                                                   Pr(>|t|)    
## (Intercept)                                        < 2e-16 ***
## log10Length                                        < 2e-16 ***
## speciesBrook Trout                                 < 2e-16 ***
## speciesBrown Trout                                 < 2e-16 ***
## speciesBull Trout                                  < 2e-16 ***
## speciesColorado River Cutthroat Trout             6.22e-09 ***
## speciesMountain Whitefish                         1.20e-15 ***
## speciesRainbow Trout                               < 2e-16 ***
## speciesWestslope Cutthroat Trout                   < 2e-16 ***
## speciesYellowstone Cutthroat Trout                9.19e-08 ***
## log10Length:speciesBrook Trout                     < 2e-16 ***
## log10Length:speciesBrown Trout                     < 2e-16 ***
## log10Length:speciesBull Trout                      < 2e-16 ***
## log10Length:speciesColorado River Cutthroat Trout 4.86e-08 ***
## log10Length:speciesMountain Whitefish             0.000127 ***
## log10Length:speciesRainbow Trout                   < 2e-16 ***
## log10Length:speciesWestslope Cutthroat Trout       < 2e-16 ***
## log10Length:speciesYellowstone Cutthroat Trout    6.07e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.07085 on 2195321 degrees of freedom
## Multiple R-squared:  0.9831, Adjusted R-squared:  0.9831 
## F-statistic: 7.526e+06 on 17 and 2195321 DF,  p-value: < 2.2e-16
\end{verbatim}

LW relationships differ between lakes and streams. Intercepts are higher
and slopes smaller in streams compared to lakes. Except for Rainbow
Trout, which has opposite pattern

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{modLS1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(log10Weight }\OperatorTok{~}\StringTok{ }\NormalTok{log10Length }\OperatorTok{*}\StringTok{ }\NormalTok{species }\OperatorTok{*}\StringTok{ }\NormalTok{site_type, }\DataTypeTok{data =}\NormalTok{ dat)}

\KeywordTok{AIC}\NormalTok{(modSpp1, modLS1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         df      AIC
## modSpp1 19 -5393099
## modLS1  33 -5405136
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{anova}\NormalTok{(modLS1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: log10Weight
##                                    Df Sum Sq Mean Sq    F value    Pr(>F)    
## log10Length                         1 641647  641647 1.2854e+08 < 2.2e-16 ***
## species                             8    378      47 9.4546e+03 < 2.2e-16 ***
## site_type                           1      6       6 1.2636e+03 < 2.2e-16 ***
## log10Length:species                 8    137      17 3.4417e+03 < 2.2e-16 ***
## log10Length:site_type               1     12      12 2.3889e+03 < 2.2e-16 ***
## species:site_type                   6     39       7 1.3024e+03 < 2.2e-16 ***
## log10Length:species:site_type       6      8       1 2.7347e+02 < 2.2e-16 ***
## Residuals                     2195307  10958       0                         
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(modLS1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = log10Weight ~ log10Length * species * site_type, 
##     data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.04961 -0.03805 -0.00114  0.03631  1.04198 
## 
## Coefficients: (4 not defined because of singularities)
##                                                                    Estimate
## (Intercept)                                                       -5.338871
## log10Length                                                        3.116194
## speciesBrook Trout                                                -0.246980
## speciesBrown Trout                                                 0.211783
## speciesBull Trout                                                 -0.135876
## speciesColorado River Cutthroat Trout                             -0.346001
## speciesMountain Whitefish                                         -0.180500
## speciesRainbow Trout                                               0.587207
## speciesWestslope Cutthroat Trout                                   0.176943
## speciesYellowstone Cutthroat Trout                                 0.012649
## site_typestream                                                    0.287620
## log10Length:speciesBrook Trout                                     0.133364
## log10Length:speciesBrown Trout                                    -0.071601
## log10Length:speciesBull Trout                                      0.045713
## log10Length:speciesColorado River Cutthroat Trout                  0.159067
## log10Length:speciesMountain Whitefish                              0.076971
## log10Length:speciesRainbow Trout                                  -0.206001
## log10Length:speciesWestslope Cutthroat Trout                      -0.046884
## log10Length:speciesYellowstone Cutthroat Trout                    -0.001699
## log10Length:site_typestream                                       -0.095570
## speciesBrook Trout:site_typestream                                 0.167895
## speciesBrown Trout:site_typestream                                 0.078584
## speciesBull Trout:site_typestream                                  0.269052
## speciesColorado River Cutthroat Trout:site_typestream                    NA
## speciesMountain Whitefish:site_typestream                          0.167250
## speciesRainbow Trout:site_typestream                              -0.270524
## speciesWestslope Cutthroat Trout:site_typestream                  -0.074756
## speciesYellowstone Cutthroat Trout:site_typestream                       NA
## log10Length:speciesBrook Trout:site_typestream                    -0.090768
## log10Length:speciesBrown Trout:site_typestream                    -0.047461
## log10Length:speciesBull Trout:site_typestream                     -0.120573
## log10Length:speciesColorado River Cutthroat Trout:site_typestream        NA
## log10Length:speciesMountain Whitefish:site_typestream             -0.082729
## log10Length:speciesRainbow Trout:site_typestream                   0.082872
## log10Length:speciesWestslope Cutthroat Trout:site_typestream       0.001268
## log10Length:speciesYellowstone Cutthroat Trout:site_typestream           NA
##                                                                   Std. Error
## (Intercept)                                                         0.016210
## log10Length                                                         0.006652
## speciesBrook Trout                                                  0.022281
## speciesBrown Trout                                                  0.021537
## speciesBull Trout                                                   0.028767
## speciesColorado River Cutthroat Trout                               0.059381
## speciesMountain Whitefish                                           0.022885
## speciesRainbow Trout                                                0.017140
## speciesWestslope Cutthroat Trout                                    0.021239
## speciesYellowstone Cutthroat Trout                                  0.006587
## site_typestream                                                     0.015165
## log10Length:speciesBrook Trout                                      0.009205
## log10Length:speciesBrown Trout                                      0.008628
## log10Length:speciesBull Trout                                       0.011314
## log10Length:speciesColorado River Cutthroat Trout                   0.029073
## log10Length:speciesMountain Whitefish                               0.009369
## log10Length:speciesRainbow Trout                                    0.007011
## log10Length:speciesWestslope Cutthroat Trout                        0.008661
## log10Length:speciesYellowstone Cutthroat Trout                      0.002942
## log10Length:site_typestream                                         0.006120
## speciesBrook Trout:site_typestream                                  0.021775
## speciesBrown Trout:site_typestream                                  0.020792
## speciesBull Trout:site_typestream                                   0.028694
## speciesColorado River Cutthroat Trout:site_typestream                     NA
## speciesMountain Whitefish:site_typestream                           0.022743
## speciesRainbow Trout:site_typestream                                0.016215
## speciesWestslope Cutthroat Trout:site_typestream                    0.020587
## speciesYellowstone Cutthroat Trout:site_typestream                        NA
## log10Length:speciesBrook Trout:site_typestream                      0.008953
## log10Length:speciesBrown Trout:site_typestream                      0.008237
## log10Length:speciesBull Trout:site_typestream                       0.011265
## log10Length:speciesColorado River Cutthroat Trout:site_typestream         NA
## log10Length:speciesMountain Whitefish:site_typestream               0.009236
## log10Length:speciesRainbow Trout:site_typestream                    0.006533
## log10Length:speciesWestslope Cutthroat Trout:site_typestream        0.008328
## log10Length:speciesYellowstone Cutthroat Trout:site_typestream            NA
##                                                                    t value
## (Intercept)                                                       -329.347
## log10Length                                                        468.426
## speciesBrook Trout                                                 -11.085
## speciesBrown Trout                                                   9.834
## speciesBull Trout                                                   -4.723
## speciesColorado River Cutthroat Trout                               -5.827
## speciesMountain Whitefish                                           -7.887
## speciesRainbow Trout                                                34.260
## speciesWestslope Cutthroat Trout                                     8.331
## speciesYellowstone Cutthroat Trout                                   1.920
## site_typestream                                                     18.966
## log10Length:speciesBrook Trout                                      14.488
## log10Length:speciesBrown Trout                                      -8.299
## log10Length:speciesBull Trout                                        4.041
## log10Length:speciesColorado River Cutthroat Trout                    5.471
## log10Length:speciesMountain Whitefish                                8.216
## log10Length:speciesRainbow Trout                                   -29.383
## log10Length:speciesWestslope Cutthroat Trout                        -5.413
## log10Length:speciesYellowstone Cutthroat Trout                      -0.577
## log10Length:site_typestream                                        -15.616
## speciesBrook Trout:site_typestream                                   7.710
## speciesBrown Trout:site_typestream                                   3.780
## speciesBull Trout:site_typestream                                    9.377
## speciesColorado River Cutthroat Trout:site_typestream                   NA
## speciesMountain Whitefish:site_typestream                            7.354
## speciesRainbow Trout:site_typestream                               -16.684
## speciesWestslope Cutthroat Trout:site_typestream                    -3.631
## speciesYellowstone Cutthroat Trout:site_typestream                      NA
## log10Length:speciesBrook Trout:site_typestream                     -10.138
## log10Length:speciesBrown Trout:site_typestream                      -5.762
## log10Length:speciesBull Trout:site_typestream                      -10.703
## log10Length:speciesColorado River Cutthroat Trout:site_typestream       NA
## log10Length:speciesMountain Whitefish:site_typestream               -8.957
## log10Length:speciesRainbow Trout:site_typestream                    12.686
## log10Length:speciesWestslope Cutthroat Trout:site_typestream         0.152
## log10Length:speciesYellowstone Cutthroat Trout:site_typestream          NA
##                                                                   Pr(>|t|)    
## (Intercept)                                                        < 2e-16 ***
## log10Length                                                        < 2e-16 ***
## speciesBrook Trout                                                 < 2e-16 ***
## speciesBrown Trout                                                 < 2e-16 ***
## speciesBull Trout                                                 2.32e-06 ***
## speciesColorado River Cutthroat Trout                             5.65e-09 ***
## speciesMountain Whitefish                                         3.09e-15 ***
## speciesRainbow Trout                                               < 2e-16 ***
## speciesWestslope Cutthroat Trout                                   < 2e-16 ***
## speciesYellowstone Cutthroat Trout                                0.054811 .  
## site_typestream                                                    < 2e-16 ***
## log10Length:speciesBrook Trout                                     < 2e-16 ***
## log10Length:speciesBrown Trout                                     < 2e-16 ***
## log10Length:speciesBull Trout                                     5.33e-05 ***
## log10Length:speciesColorado River Cutthroat Trout                 4.47e-08 ***
## log10Length:speciesMountain Whitefish                              < 2e-16 ***
## log10Length:speciesRainbow Trout                                   < 2e-16 ***
## log10Length:speciesWestslope Cutthroat Trout                      6.20e-08 ***
## log10Length:speciesYellowstone Cutthroat Trout                    0.563679    
## log10Length:site_typestream                                        < 2e-16 ***
## speciesBrook Trout:site_typestream                                1.25e-14 ***
## speciesBrown Trout:site_typestream                                0.000157 ***
## speciesBull Trout:site_typestream                                  < 2e-16 ***
## speciesColorado River Cutthroat Trout:site_typestream                   NA    
## speciesMountain Whitefish:site_typestream                         1.93e-13 ***
## speciesRainbow Trout:site_typestream                               < 2e-16 ***
## speciesWestslope Cutthroat Trout:site_typestream                  0.000282 ***
## speciesYellowstone Cutthroat Trout:site_typestream                      NA    
## log10Length:speciesBrook Trout:site_typestream                     < 2e-16 ***
## log10Length:speciesBrown Trout:site_typestream                    8.32e-09 ***
## log10Length:speciesBull Trout:site_typestream                      < 2e-16 ***
## log10Length:speciesColorado River Cutthroat Trout:site_typestream       NA    
## log10Length:speciesMountain Whitefish:site_typestream              < 2e-16 ***
## log10Length:speciesRainbow Trout:site_typestream                   < 2e-16 ***
## log10Length:speciesWestslope Cutthroat Trout:site_typestream      0.878982    
## log10Length:speciesYellowstone Cutthroat Trout:site_typestream          NA    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.07065 on 2195307 degrees of freedom
## Multiple R-squared:  0.9832, Adjusted R-squared:  0.9832 
## F-statistic: 4.15e+06 on 31 and 2195307 DF,  p-value: < 2.2e-16
\end{verbatim}

Drainage area effect seems to only affect Bull Trout LW relationship.
Increase in slope with drainage area for Bull Trout.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{modDA0 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(log10Weight }\OperatorTok{~}\StringTok{ }\NormalTok{log10Length }\OperatorTok{*}\StringTok{ }\NormalTok{species, }\DataTypeTok{data =}\NormalTok{ dat }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(site_type }\OperatorTok{==}\StringTok{ "stream"}\NormalTok{))}
\NormalTok{modDA1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(log10Weight }\OperatorTok{~}\StringTok{ }\NormalTok{log10Length }\OperatorTok{*}\StringTok{ }\NormalTok{species }\OperatorTok{*}\StringTok{ }\NormalTok{drain_area_km2, }\DataTypeTok{data =}\NormalTok{ dat }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(site_type }\OperatorTok{==}\StringTok{ "stream"}\NormalTok{))}

\KeywordTok{AIC}\NormalTok{(modDA0, modDA1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        df      AIC
## modDA0 19 -5141834
## modDA1 37 -5196192
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{anova}\NormalTok{(modDA1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: log10Weight
##                                         Df Sum Sq Mean Sq    F value    Pr(>F)
## log10Length                              1 618688  618688 1.2931e+08 < 2.2e-16
## species                                  8    336      42 8.7858e+03 < 2.2e-16
## drain_area_km2                           1    131     131 2.7399e+04 < 2.2e-16
## log10Length:species                      8    148      18 3.8556e+03 < 2.2e-16
## log10Length:drain_area_km2               1     85      85 1.7739e+04 < 2.2e-16
## species:drain_area_km2                   8      8       1 2.1242e+02 < 2.2e-16
## log10Length:species:drain_area_km2       8     11       1 2.9677e+02 < 2.2e-16
## Residuals                          2074748   9927       0                     
##                                       
## log10Length                        ***
## species                            ***
## drain_area_km2                     ***
## log10Length:species                ***
## log10Length:drain_area_km2         ***
## species:drain_area_km2             ***
## log10Length:species:drain_area_km2 ***
## Residuals                             
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(modDA1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = log10Weight ~ log10Length * species * drain_area_km2, 
##     data = dat %>% filter(site_type == "stream"))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.04008 -0.03699 -0.00108  0.03552  1.02124 
## 
## Coefficients:
##                                                                    Estimate
## (Intercept)                                                      -5.058e+00
## log10Length                                                       3.024e+00
## speciesBrook Trout                                               -7.460e-02
## speciesBrown Trout                                                2.719e-01
## speciesBull Trout                                                 1.585e-01
## speciesColorado River Cutthroat Trout                            -3.930e-01
## speciesMountain Whitefish                                         1.175e-02
## speciesRainbow Trout                                              2.494e-01
## speciesWestslope Cutthroat Trout                                  1.194e-01
## speciesYellowstone Cutthroat Trout                                2.718e-03
## drain_area_km2                                                    9.716e-06
## log10Length:speciesBrook Trout                                    4.039e-02
## log10Length:speciesBrown Trout                                   -1.147e-01
## log10Length:speciesBull Trout                                    -8.643e-02
## log10Length:speciesColorado River Cutthroat Trout                 1.824e-01
## log10Length:speciesMountain Whitefish                            -1.721e-02
## log10Length:speciesRainbow Trout                                 -1.004e-01
## log10Length:speciesWestslope Cutthroat Trout                     -5.400e-02
## log10Length:speciesYellowstone Cutthroat Trout                    4.351e-03
## log10Length:drain_area_km2                                       -5.251e-06
## speciesBrook Trout:drain_area_km2                                -4.456e-07
## speciesBrown Trout:drain_area_km2                                -4.470e-06
## speciesBull Trout:drain_area_km2                                 -4.586e-05
## speciesColorado River Cutthroat Trout:drain_area_km2              5.773e-04
## speciesMountain Whitefish:drain_area_km2                         -1.242e-05
## speciesRainbow Trout:drain_area_km2                              -1.776e-07
## speciesWestslope Cutthroat Trout:drain_area_km2                  -2.882e-06
## speciesYellowstone Cutthroat Trout:drain_area_km2                -1.312e-05
## log10Length:speciesBrook Trout:drain_area_km2                     1.104e-06
## log10Length:speciesBrown Trout:drain_area_km2                     3.376e-06
## log10Length:speciesBull Trout:drain_area_km2                      1.974e-05
## log10Length:speciesColorado River Cutthroat Trout:drain_area_km2 -2.679e-04
## log10Length:speciesMountain Whitefish:drain_area_km2              6.502e-06
## log10Length:speciesRainbow Trout:drain_area_km2                   1.701e-06
## log10Length:speciesWestslope Cutthroat Trout:drain_area_km2       2.793e-06
## log10Length:speciesYellowstone Cutthroat Trout:drain_area_km2     6.072e-06
##                                                                  Std. Error
## (Intercept)                                                       5.791e-03
## log10Length                                                       2.637e-03
## speciesBrook Trout                                                6.650e-03
## speciesBrown Trout                                                5.935e-03
## speciesBull Trout                                                 8.177e-03
## speciesColorado River Cutthroat Trout                             6.312e-02
## speciesMountain Whitefish                                         8.125e-03
## speciesRainbow Trout                                              6.046e-03
## speciesWestslope Cutthroat Trout                                  6.300e-03
## speciesYellowstone Cutthroat Trout                                6.991e-03
## drain_area_km2                                                    1.200e-05
## log10Length:speciesBrook Trout                                    3.036e-03
## log10Length:speciesBrown Trout                                    2.689e-03
## log10Length:speciesBull Trout                                     3.702e-03
## log10Length:speciesColorado River Cutthroat Trout                 3.097e-02
## log10Length:speciesMountain Whitefish                             3.511e-03
## log10Length:speciesRainbow Trout                                  2.731e-03
## log10Length:speciesWestslope Cutthroat Trout                      2.871e-03
## log10Length:speciesYellowstone Cutthroat Trout                    3.126e-03
## log10Length:drain_area_km2                                        4.888e-06
## speciesBrook Trout:drain_area_km2                                 1.318e-05
## speciesBrown Trout:drain_area_km2                                 1.200e-05
## speciesBull Trout:drain_area_km2                                  1.274e-05
## speciesColorado River Cutthroat Trout:drain_area_km2              5.628e-04
## speciesMountain Whitefish:drain_area_km2                          1.201e-05
## speciesRainbow Trout:drain_area_km2                               1.200e-05
## speciesWestslope Cutthroat Trout:drain_area_km2                   1.209e-05
## speciesYellowstone Cutthroat Trout:drain_area_km2                 1.205e-05
## log10Length:speciesBrook Trout:drain_area_km2                     5.380e-06
## log10Length:speciesBrown Trout:drain_area_km2                     4.888e-06
## log10Length:speciesBull Trout:drain_area_km2                      5.163e-06
## log10Length:speciesColorado River Cutthroat Trout:drain_area_km2  2.305e-04
## log10Length:speciesMountain Whitefish:drain_area_km2              4.892e-06
## log10Length:speciesRainbow Trout:drain_area_km2                   4.888e-06
## log10Length:speciesWestslope Cutthroat Trout:drain_area_km2       4.922e-06
## log10Length:speciesYellowstone Cutthroat Trout:drain_area_km2     4.907e-06
##                                                                   t value
## (Intercept)                                                      -873.510
## log10Length                                                      1146.950
## speciesBrook Trout                                                -11.217
## speciesBrown Trout                                                 45.818
## speciesBull Trout                                                  19.377
## speciesColorado River Cutthroat Trout                              -6.227
## speciesMountain Whitefish                                           1.446
## speciesRainbow Trout                                               41.254
## speciesWestslope Cutthroat Trout                                   18.950
## speciesYellowstone Cutthroat Trout                                  0.389
## drain_area_km2                                                      0.810
## log10Length:speciesBrook Trout                                     13.306
## log10Length:speciesBrown Trout                                    -42.640
## log10Length:speciesBull Trout                                     -23.347
## log10Length:speciesColorado River Cutthroat Trout                   5.888
## log10Length:speciesMountain Whitefish                              -4.903
## log10Length:speciesRainbow Trout                                  -36.783
## log10Length:speciesWestslope Cutthroat Trout                      -18.808
## log10Length:speciesYellowstone Cutthroat Trout                      1.392
## log10Length:drain_area_km2                                         -1.074
## speciesBrook Trout:drain_area_km2                                  -0.034
## speciesBrown Trout:drain_area_km2                                  -0.372
## speciesBull Trout:drain_area_km2                                   -3.601
## speciesColorado River Cutthroat Trout:drain_area_km2                1.026
## speciesMountain Whitefish:drain_area_km2                           -1.034
## speciesRainbow Trout:drain_area_km2                                -0.015
## speciesWestslope Cutthroat Trout:drain_area_km2                    -0.238
## speciesYellowstone Cutthroat Trout:drain_area_km2                  -1.089
## log10Length:speciesBrook Trout:drain_area_km2                       0.205
## log10Length:speciesBrown Trout:drain_area_km2                       0.691
## log10Length:speciesBull Trout:drain_area_km2                        3.823
## log10Length:speciesColorado River Cutthroat Trout:drain_area_km2   -1.162
## log10Length:speciesMountain Whitefish:drain_area_km2                1.329
## log10Length:speciesRainbow Trout:drain_area_km2                     0.348
## log10Length:speciesWestslope Cutthroat Trout:drain_area_km2         0.567
## log10Length:speciesYellowstone Cutthroat Trout:drain_area_km2       1.237
##                                                                  Pr(>|t|)    
## (Intercept)                                                       < 2e-16 ***
## log10Length                                                       < 2e-16 ***
## speciesBrook Trout                                                < 2e-16 ***
## speciesBrown Trout                                                < 2e-16 ***
## speciesBull Trout                                                 < 2e-16 ***
## speciesColorado River Cutthroat Trout                            4.76e-10 ***
## speciesMountain Whitefish                                        0.148232    
## speciesRainbow Trout                                              < 2e-16 ***
## speciesWestslope Cutthroat Trout                                  < 2e-16 ***
## speciesYellowstone Cutthroat Trout                               0.697406    
## drain_area_km2                                                   0.418128    
## log10Length:speciesBrook Trout                                    < 2e-16 ***
## log10Length:speciesBrown Trout                                    < 2e-16 ***
## log10Length:speciesBull Trout                                     < 2e-16 ***
## log10Length:speciesColorado River Cutthroat Trout                3.90e-09 ***
## log10Length:speciesMountain Whitefish                            9.46e-07 ***
## log10Length:speciesRainbow Trout                                  < 2e-16 ***
## log10Length:speciesWestslope Cutthroat Trout                      < 2e-16 ***
## log10Length:speciesYellowstone Cutthroat Trout                   0.163935    
## log10Length:drain_area_km2                                       0.282691    
## speciesBrook Trout:drain_area_km2                                0.973029    
## speciesBrown Trout:drain_area_km2                                0.709534    
## speciesBull Trout:drain_area_km2                                 0.000317 ***
## speciesColorado River Cutthroat Trout:drain_area_km2             0.304980    
## speciesMountain Whitefish:drain_area_km2                         0.301171    
## speciesRainbow Trout:drain_area_km2                              0.988190    
## speciesWestslope Cutthroat Trout:drain_area_km2                  0.811509    
## speciesYellowstone Cutthroat Trout:drain_area_km2                0.276097    
## log10Length:speciesBrook Trout:drain_area_km2                    0.837373    
## log10Length:speciesBrown Trout:drain_area_km2                    0.489735    
## log10Length:speciesBull Trout:drain_area_km2                     0.000132 ***
## log10Length:speciesColorado River Cutthroat Trout:drain_area_km2 0.245042    
## log10Length:speciesMountain Whitefish:drain_area_km2             0.183805    
## log10Length:speciesRainbow Trout:drain_area_km2                  0.727846    
## log10Length:speciesWestslope Cutthroat Trout:drain_area_km2      0.570382    
## log10Length:speciesYellowstone Cutthroat Trout:drain_area_km2    0.215954    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.06917 on 2074748 degrees of freedom
## Multiple R-squared:  0.9842, Adjusted R-squared:  0.9842 
## F-statistic: 3.699e+06 on 35 and 2074748 DF,  p-value: < 2.2e-16
\end{verbatim}

Lake size effect? Temp and flow effects?

\end{document}
